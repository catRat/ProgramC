\chapter{用户自己建立数据类型}
C语言提供了一些由系统已定义好的数据类型，如：int，float，char等，用户可以在程序中用它们定义变量，解决一般的问题，但是人们要处理的问题往往比较复杂，只有系统提供的类型还不能满足应用的要求，C语言允许用户根据需要自己建立一些数据类型，用它来定义变量。
\section{定义和使用结构体变量}
\subsection{自己建立结构体类型}
在前面所见到的程序中，所有的变量大多数是相互独立、无内在联系的……C语言允许用户自己建立由不同数据组成的组合型的数据结构，它成为结构体（structre)。在其他一些高级语言中称为“记录”（record）。
\subsection{定义结构提类型变量}
前面只是建立了一个结构体类型，它相当于一个模型，并没有定义变量，其中并无具体数据，系统对之也不分配存储单元。为了能在程序中使用结构体类型的数据，应当定义结构体类型的变量，并在其中存放具体的数据。
\begin{enumerate}
	\item 先声明结构提类型，再定义该类型的变量

		前面已经声明了一个结构体类型struct Student，可以用它来定义变量。

	\item 在声明类型的同时定义变量
		
		\begin{lstlisting}
		struct Student
		{int num;
		char name[20];
		char sex;
		int age;
		float score;
		char addr[30];
		} student1, student2;
		\end{lstlisting}

	\item 不指定类型名而直接定义结构提类型变量
		\begin{lstlisting}
		struct 
		{
			成员列表
			}变量名列表;
		\end{lstlisting}
		显然不能再以此结构体类型去定义其他变量。这种方式用得不多。
\end{enumerate}
\subsection{结构体变量的初始化和引用}
在定义结构提变量是，可以对它初始化，即赋予初始值。然后可以引用这个变量。
\begin{lstlisting}
struct Student
{long itn num;
} a = {1};
\end{lstlisting}

例 输入两个学生的学好、姓名和成绩，输出成绩较高的学好的学号、姓名和成绩。
\begin{lstlisting}
struct Person
{char name[20];
int count;
}leader[3] = {"Li", 0, "Zhang", 0, "Sun", 0};
int main(void)
{
	...
}
\end{lstlisting}

\section{使用结构体数组}
一个结构体变量中可以存放一组有关联的数据。如果有10个学生的数据需要参加运算，显然应该用数组，这就是结构体数组。结构提数组与以前介绍过的数值型数组的不同之处在于每个数组元素都是一个结构体类型的数据。
\subsection{定义结构体数组}
下面举一个简单的例子来说明定义和引用结构体数组。

例 有3个候选人，每个选民只能投票选一个人，要求编一个统计选票的程序，先后输入被选人的名字，最后输出各人得票结果。
\subsection{结构体数组的应用举例}
例 有n个学生的信息，要求按照成绩的高低顺序输出各学生的信息。

\section{结构体指针}
所谓结构提指针就是指向结构体变量的指针，一个结构提变量的起始地址就是这个结构提变量的指针。
\subsection{指向结构体的指针}
指向结构体对象的指针即可指向结构体变量，也可指向结构体数组中的元素。指针变量的基类型必须与结构体变量的类型相同。
\subsection{指向结构体数组的指针}
可以用指针变量指向结构体数组的元素。
\subsection{用结构体变量和结构体变量的指针作函数参数}
将一个结构提变量的值传递给另一个函数，有3个方法：
\begin{enumerate}
	\item 用结构体变量的成员作参数。
	\item 用结构体变量作实际参数。
	\item 用指向结构体变量的指针作实际参数。
\end{enumerate}

\section{用指针处理链表}
\subsection{什么是链表}
链表是一种常见的重要的数据结构。它是动态地进行分配的一种结构。由前面的介绍中已知：用数组存放数据时，必须事先定义固定的数组长度。

链表有一个“头指针”变量。链表中每一个元素称为“结点”，每个结点都应包括两个部分：（1）用户需要用的实际数据；（2）下一个结点的地址。

可以看到链表中各元素在内存中搞得地址可以是不连续的。要找某一元素，必须先找到上一个元素，根据它提供的下一个元素地址才能找到下一个元素。

显然，链表这种数据结构，必须利用指针变量才能实现，即一个结点中应包含一个指针变量，用它存放下一结点的地址。

前面介绍了结构体变量，用它去建立链表是最合适的。一个结构体变量包含若干成员，这些成员可以是数值类型、字符类型、数组类型，也可以是指针类型。用指针类型来存放下一个结点的地址。
\begin{lstlisting}
struct Student
{
	int num;
	float score;
	struct Student * next;
}
\end{lstlisting}
\subsection{建立简单的静态链表}
下面通过一个例子来说明怎样建立和输出一个简单链表。

例 建立如图的简单链表，其成员包括num，score，next。
\subsection{建立动态链表}
所谓建立动态链表是指在程序执行过程中从无到有地建立一个链表，即一个一个地开辟结点和输入各结点数据，并建立起相连的关系。

例 写一函数建立一个有3名学生数据的单向动态链表。
\subsection{输出链表}
将链表中各结点数据依次输出。
\section{共用体类型}
\subsection{什么是共用体类型}
有时想用同一段内存单元存放不同类型的变量。
\subsection{引用共用体变量的方式}
\subsection{共用体类型数据的特点}
\section{使用枚举类型}
\section{用typedef声明新类型名}
除了可以直接使用C提供的标准类型名和程序编写者自己声明的结构体、共用体、枚举类型外，还可以用typedef指定新的类型名来代替已有的类型名。有以下两种情况：
\begin{enumerate}
	\item 简单地用一个新的类型名代替原有的类型名。
	\item 命名一个简单的类型名代替复杂的类型表示方法。
\end{enumerate}
\section{习题}
\begin{enumerate}
	\item 定义一个结构提变量（包括年、月、日）。计算该日在本年中是第几天，注意润年问题。
	\item 写一个函数days，是想第1题的计算。
	\item 编写一个函数print，打印一个学生的成绩数组，该数组中有5个学生的数据记录，每个记录每个记录包括num, name, \verb| score[3]|，用主函数输入这些记录，用print函数输出这些记录。
	\item 在第3提的基础上，编写一个函数input，用来输入5个学生的数据记录。
	\item 有10个学生，每个学生的数据包括学好、姓名、3门课程的成绩，从键盘输入10个学生数据，要求输出3们课程总平均成绩，以及最高分的学生的成绩（包括学号、姓名、3门课程成绩、平均分数）。
	\item 13个人围成一圈，从第1个人开始顺序报号1, 2, 3.凡报到3者退出圈子。找出最后留在圈子中的人原来的序号。要求用链表实现。
	\item 在第9章例9.9和例9.10的基础上，写一个函数del，用来删除动态链表中的制定节点。
	\item 写一个函数insert，用来向一个动态链表插入结点。
	\item 综合本章例9.9和本章习题第7题，在写一个主函数，先后调用这个函数。用以上5个函数组成一个程序，实现链表的建立、输出、删除和插入，在主函数中制定需要删除和插入的结点的数据。
	\item 已有a, b两个链表，每个链表中的结点包括学好、成绩。要求把两个链表合并，按学号升序排序。
	\item 有两个链表a和b，设结点中包含学号、姓名。从a链表中删去与b链表中有相同学号的那些结点。
	\item 建立一个链表，每个结点包括：学好、姓名、性别、年龄。输入一个年龄，如果链表中的结点所包含的年龄等于此年龄，则将此节点删去。
\end{enumerate}
